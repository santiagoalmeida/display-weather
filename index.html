<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pantalla Publicitaria</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            background: #000;
        }

        .pantalla-container {
            position: relative;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: background-image 0.5s ease-in-out;
        }

        .widget-temperatura {
            position: absolute;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .temperatura-principal {
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            line-height: 1;
        }

        .grados-simbolo {
            vertical-align: top;
        }

        .mensaje-temperatura {
            font-weight: 300;
            line-height: 1.4;
            margin-top: 20px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .ubicacion {
            opacity: 0.9;
            margin-top: 15px;
            font-weight: 500;
        }

        .icono-clima {
            margin-bottom: 10px;
        }

        .fecha-hora {
            margin-top: 10px;
            opacity: 0.9;
        }

        .error-imagen {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            display: none;
        }
    </style>
</head>
<body>
    <!-- Cargar archivo de configuraci√≥n -->
    <script src="config.js"></script>
    
    <div class="pantalla-container" id="pantallaContainer">
        <div class="widget-temperatura" id="widgetTemperatura">
            <div class="icono-clima" id="iconoClima">‚òÄÔ∏è</div>
            <div class="temperatura-principal">
                <span id="temperatura">--</span><span class="grados-simbolo">¬∞</span>
            </div>
            <div class="mensaje-temperatura" id="mensaje">
                Hoy estamos a <span id="tempMensaje">--</span>¬∞<br>
                momento perfecto para<br>
                <strong>llenarte de frescura</strong>
            </div>
            <div class="ubicacion" id="ubicacion">üìç Tu ubicaci√≥n</div>
            <div class="fecha-hora" id="fechaHora"></div>
        </div>
        <div class="error-imagen" id="errorImagen">Error cargando imagen</div>
    </div>

    <script>
        class PantallaPersonalizable {
            constructor(config = {}) {
                // üéØ CONFIGURACI√ìN PERSONALIZABLE
                this.LATITUD = config.latitud || -2.1962;
                this.LONGITUD = config.longitud || -79.8862;
                this.CIUDAD = config.ciudad || 'Guayaquil';
                this.PAIS = config.pais || 'Ecuador';
                this.IMAGEN_URL = config.imagenUrl || 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80';
                this.ANCHO_PANTALLA = config.anchoPantalla || 1366;
                this.ALTO_PANTALLA = config.altoPantalla || 768;
                
                // üé® CONFIGURACI√ìN DE ESTILO DEL WIDGET
                this.ESTILO = {
                    // Posici√≥n del widget
                    posicion: config.estilo?.posicion || 'superior-izquierda', // 'superior-izquierda', 'superior-derecha', 'inferior-izquierda', 'inferior-derecha', 'centro', 'personalizada'
                    posicionX: config.estilo?.posicionX || 0, // Posici√≥n X personalizada (solo si posicion es 'personalizada')
                    posicionY: config.estilo?.posicionY || 0, // Posici√≥n Y personalizada (solo si posicion es 'personalizada')
                    margen: config.estilo?.margen || 20, // Margen desde los bordes de la pantalla
                    
                    // Tama√±o del widget
                    ancho: config.estilo?.ancho || 384,
                    alto: config.estilo?.alto || 432,
                    
                    // Colores
                    colorFondo: config.estilo?.colorFondo || '#667eea', // Color principal del fondo
                    colorFondo2: config.estilo?.colorFondo2 || '#764ba2', // Color secundario para gradiente
                    colorTexto: config.estilo?.colorTexto || '#ffffff',
                    
                    // Tipograf√≠a
                    fuentePrincipal: config.estilo?.fuentePrincipal || 'Arial, sans-serif',
                    tamanoTemperatura: config.estilo?.tamanoTemperatura || 120, // Tama√±o de la temperatura principal
                    tamanoGrados: config.estilo?.tamanoGrados || 60, // Tama√±o del s√≠mbolo de grados
                    tamanoMensaje: config.estilo?.tamanoMensaje || 24, // Tama√±o del mensaje
                    tamanoUbicacion: config.estilo?.tamanoUbicacion || 18, // Tama√±o de la ubicaci√≥n
                    tamanoFecha: config.estilo?.tamanoFecha || 16, // Tama√±o de fecha/hora
                    tamanoIcono: config.estilo?.tamanoIcono || 40, // Tama√±o del icono del clima
                    
                    // Bordes y efectos
                    bordeRadio: config.estilo?.bordeRadio || 20, // Radio de las esquinas
                    transparencia: config.estilo?.transparencia || 1.0, // Transparencia del widget (0.0 a 1.0)
                    sombra: config.estilo?.sombra || true, // Mostrar sombra
                    
                    // Mensajes personalizables
                    mostrarMensaje: config.estilo?.mostrarMensaje !== undefined ? config.estilo.mostrarMensaje : true, // Mostrar o ocultar mensajes
                    mensajes: config.estilo?.mensajes || {
                        muyCaliente: {
                            texto: 'Hoy estamos a {temp}¬∞<br>momento perfecto para<br><strong>refrescarte</strong>',
                            accion: 'refrescarte'
                        },
                        caliente: {
                            texto: 'Hoy estamos a {temp}¬∞<br>momento perfecto para<br><strong>llenarte de frescura</strong>',
                            accion: 'llenarte de frescura'
                        },
                        templado: {
                            texto: 'Hoy estamos a {temp}¬∞<br>momento perfecto para<br><strong>disfrutar el d√≠a</strong>',
                            accion: 'disfrutar el d√≠a'
                        },
                        fresco: {
                            texto: 'Hoy estamos a {temp}¬∞<br>momento perfecto para<br><strong>salir a caminar</strong>',
                            accion: 'salir a caminar'
                        },
                        frio: {
                            texto: 'Hoy estamos a {temp}¬∞<br>momento perfecto para<br><strong>algo caliente</strong>',
                            accion: 'algo caliente'
                        }
                    }
                };
                
                this.inicializar();
                this.configurarPantalla();
                this.configurarEstiloWidget();
                this.configurarImagen();
                this.actualizarFechaHora();
                setInterval(() => this.actualizarFechaHora(), 60000);
                setInterval(() => this.actualizarTemperatura(), 600000); // Cada 10 minutos
            }

            inicializar() {
                this.actualizarTemperatura();
            }

            configurarPantalla() {
                const container = document.getElementById('pantallaContainer');
                container.style.width = `${this.ANCHO_PANTALLA}px`;
                container.style.height = `${this.ALTO_PANTALLA}px`;
            }

            configurarEstiloWidget() {
                const widget = document.getElementById('widgetTemperatura');
                const temperatura = document.getElementById('temperatura');
                const gradosSymbol = document.querySelector('.grados-simbolo');
                const mensaje = document.getElementById('mensaje');
                const ubicacion = document.getElementById('ubicacion');
                const fechaHora = document.getElementById('fechaHora');
                const iconoClima = document.getElementById('iconoClima');
                
                // Configurar tama√±o del widget
                widget.style.width = `${this.ESTILO.ancho}px`;
                widget.style.height = `${this.ESTILO.alto}px`;
                
                // Configurar posici√≥n
                this.configurarPosicionWidget(widget);
                
                // Configurar colores y fondo
                if (this.ESTILO.colorFondo2 && this.ESTILO.colorFondo2 !== this.ESTILO.colorFondo) {
                    widget.style.background = `linear-gradient(135deg, ${this.ESTILO.colorFondo} 0%, ${this.ESTILO.colorFondo2} 100%)`;
                } else {
                    widget.style.background = this.ESTILO.colorFondo;
                }
                widget.style.color = this.ESTILO.colorTexto;
                
                // Configurar transparencia del widget (0.0 = invisible, 1.0 = completamente opaco)
                const transparencia = Math.max(0, Math.min(1, this.ESTILO.transparencia || 1.0));
                widget.style.opacity = transparencia;
                
                // Configurar tipograf√≠a
                widget.style.fontFamily = this.ESTILO.fuentePrincipal;
                
                // Configurar tama√±os de texto
                if (temperatura) temperatura.style.fontSize = `${this.ESTILO.tamanoTemperatura}px`;
                if (gradosSymbol) gradosSymbol.style.fontSize = `${this.ESTILO.tamanoGrados}px`;
                if (mensaje) mensaje.style.fontSize = `${this.ESTILO.tamanoMensaje}px`;
                if (ubicacion) ubicacion.style.fontSize = `${this.ESTILO.tamanoUbicacion}px`;
                if (fechaHora) fechaHora.style.fontSize = `${this.ESTILO.tamanoFecha}px`;
                if (iconoClima) iconoClima.style.fontSize = `${this.ESTILO.tamanoIcono}px`;
                
                // Configurar bordes y efectos
                this.configurarBordesWidget(widget);
                if (!this.ESTILO.sombra) {
                    widget.style.boxShadow = 'none';
                }
            }

            configurarBordesWidget(widget) {
                // Configurar border radius (incluyendo opci√≥n circular)
                if (this.ESTILO.bordeRadio === 'circular') {
                    // Hacer el widget circular: usar el menor de ancho/alto como di√°metro
                    const tama√±o = Math.min(this.ESTILO.ancho, this.ESTILO.alto);
                    
                    // Ajustar el widget para que sea cuadrado (necesario para c√≠rculo perfecto)
                    widget.style.width = `${tama√±o}px`;
                    widget.style.height = `${tama√±o}px`;
                    
                    // Aplicar border-radius del 50% para hacer un c√≠rculo perfecto
                    widget.style.borderRadius = '50%';
                    
                    console.log(`Widget configurado como c√≠rculo de ${tama√±o}px de di√°metro`);
                } else {
                    // Border radius normal (num√©rico)
                    const radio = typeof this.ESTILO.bordeRadio === 'number' ? this.ESTILO.bordeRadio : 20;
                    widget.style.borderRadius = `${radio}px`;
                }
            }

            configurarPosicionWidget(widget) {
                const margen = this.ESTILO.margen; // Margen configurable desde la configuraci√≥n
                
                switch (this.ESTILO.posicion) {
                    case 'superior-izquierda':
                        widget.style.top = `${margen}px`;
                        widget.style.left = `${margen}px`;
                        widget.style.right = 'auto';
                        widget.style.bottom = 'auto';
                        break;
                    case 'superior-derecha':
                        widget.style.top = `${margen}px`;
                        widget.style.right = `${margen}px`;
                        widget.style.left = 'auto';
                        widget.style.bottom = 'auto';
                        break;
                    case 'inferior-izquierda':
                        widget.style.bottom = `${margen}px`;
                        widget.style.left = `${margen}px`;
                        widget.style.top = 'auto';
                        widget.style.right = 'auto';
                        break;
                    case 'inferior-derecha':
                        widget.style.bottom = `${margen}px`;
                        widget.style.right = `${margen}px`;
                        widget.style.top = 'auto';
                        widget.style.left = 'auto';
                        break;
                    case 'centro':
                        widget.style.top = '50%';
                        widget.style.left = '50%';
                        widget.style.transform = 'translate(-50%, -50%)';
                        widget.style.right = 'auto';
                        widget.style.bottom = 'auto';
                        break;
                    case 'personalizada':
                        widget.style.top = `${this.ESTILO.posicionY}px`;
                        widget.style.left = `${this.ESTILO.posicionX}px`;
                        widget.style.right = 'auto';
                        widget.style.bottom = 'auto';
                        widget.style.transform = 'none';
                        break;
                    default:
                        // Por defecto: superior-izquierda
                        widget.style.top = `${margen}px`;
                        widget.style.left = `${margen}px`;
                        widget.style.right = 'auto';
                        widget.style.bottom = 'auto';
                }
            }

            configurarImagen() {
                const container = document.getElementById('pantallaContainer');
                const errorDiv = document.getElementById('errorImagen');
                
                // Crear una imagen temporal para verificar si carga
                const img = new Image();
                
                img.onload = () => {
                    // La imagen carg√≥ correctamente
                    container.style.backgroundImage = `url('${this.IMAGEN_URL}')`;
                    errorDiv.style.display = 'none';
                };
                
                img.onerror = () => {
                    // Error al cargar la imagen, usar imagen por defecto
                    console.warn('Error cargando imagen:', this.IMAGEN_URL);
                    const imagenPorDefecto = 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80';
                    container.style.backgroundImage = `url('${imagenPorDefecto}')`;
                    errorDiv.textContent = `Error: ${this.IMAGEN_URL}`;
                    errorDiv.style.display = 'block';
                    
                    // Ocultar error despu√©s de 5 segundos
                    setTimeout(() => {
                        errorDiv.style.display = 'none';
                    }, 5000);
                };
                
                // Iniciar la carga de la imagen
                img.src = this.IMAGEN_URL;
            }

            actualizarTemperatura() {
                const temperatura = this.calcularTemperatura();
                this.mostrarTemperatura({
                    temperature: temperatura.temp,
                    city: this.CIUDAD,
                    country: this.PAIS,
                    icon: temperatura.icono
                });
            }

            calcularTemperatura() {
                const ahora = new Date();
                const hora = ahora.getHours();
                const mes = ahora.getMonth();
                const dia = ahora.getDate();

                // Temperatura base seg√∫n tu ubicaci√≥n espec√≠fica
                let tempBase = 25;
                
                // Ajuste por latitud
                tempBase = 30 - Math.abs(this.LATITUD) * 0.8;
                
                // Ajuste por altitud estimada
                if (Math.abs(this.LATITUD) > 1) tempBase -= 5; // Zona andina
                
                // Ajuste por longitud (costa vs sierra)
                if (this.LONGITUD > -80) tempBase += 2; // Zona costera

                // Variaciones realistas
                const variacionEstacional = Math.sin((mes - 3) * Math.PI / 6) * 3;
                const variacionDiaria = Math.sin((hora - 6) * Math.PI / 12) * 8;
                const variacionAleatoria = (dia % 7) - 3;

                const temperatura = Math.round(Math.max(15, Math.min(40, 
                    tempBase + variacionEstacional + variacionDiaria + variacionAleatoria
                )));

                // Determinar icono seg√∫n temperatura y hora
                let icono;
                if (hora >= 6 && hora <= 18) {
                    // D√≠a
                    if (temperatura > 32) icono = 'üî•';
                    else if (temperatura > 28) icono = '‚òÄÔ∏è';
                    else if (temperatura > 24) icono = 'üå§Ô∏è';
                    else if (temperatura > 20) icono = '‚õÖ';
                    else icono = 'üå•Ô∏è';
                } else {
                    // Noche
                    if (temperatura > 28) icono = 'üåô';
                    else if (temperatura > 24) icono = 'üåÉ';
                    else if (temperatura > 20) icono = 'üåå';
                    else icono = 'üå•Ô∏è';
                }

                return { temp: temperatura, icono };
            }

            actualizarFechaHora() {
                const ahora = new Date();
                const opciones = { 
                    weekday: 'long', 
                    day: 'numeric',
                    month: 'long',
                    hour: '2-digit',
                    minute: '2-digit'
                };
                
                const fechaHora = ahora.toLocaleDateString('es-ES', opciones);
                document.getElementById('fechaHora').textContent = fechaHora;
            }

            mostrarTemperatura(clima) {
                // Actualizar contenido
                document.getElementById('temperatura').textContent = clima.temperature;
                document.getElementById('tempMensaje').textContent = clima.temperature;
                document.getElementById('iconoClima').textContent = clima.icon;
                
                let ubicacionTexto = `üìç ${clima.city}`;
                if (clima.country && clima.city !== clima.country) {
                    ubicacionTexto += `, ${clima.country}`;
                }
                document.getElementById('ubicacion').textContent = ubicacionTexto;

                // Controlar visibilidad del mensaje
                const mensaje = document.getElementById('mensaje');
                
                if (!this.ESTILO.mostrarMensaje) {
                    // Ocultar mensaje completamente
                    mensaje.style.display = 'none';
                    return;
                } else {
                    // Mostrar mensaje
                    mensaje.style.display = 'block';
                }

                // Seleccionar mensaje seg√∫n temperatura usando configuraci√≥n
                let mensajeConfig;
                
                if (clima.temperature > 32) {
                    mensajeConfig = this.ESTILO.mensajes.muyCaliente;
                } else if (clima.temperature > 28) {
                    mensajeConfig = this.ESTILO.mensajes.caliente;
                } else if (clima.temperature > 24) {
                    mensajeConfig = this.ESTILO.mensajes.templado;
                } else if (clima.temperature > 20) {
                    mensajeConfig = this.ESTILO.mensajes.fresco;
                } else {
                    mensajeConfig = this.ESTILO.mensajes.frio;
                }
                
                // Reemplazar {temp} con la temperatura actual
                const textoFinal = mensajeConfig.texto.replace('{temp}', clima.temperature);
                mensaje.innerHTML = textoFinal;
            }

            // M√©todo para cambiar imagen din√°micamente
            cambiarImagen(nuevaUrl) {
                this.IMAGEN_URL = nuevaUrl;
                this.configurarImagen();
            }

            // M√©todo para cambiar transparencia din√°micamente
            cambiarTransparencia(nuevaTransparencia) {
                // Validar que el valor est√© entre 0.0 y 1.0
                const transparencia = Math.max(0, Math.min(1, nuevaTransparencia));
                this.ESTILO.transparencia = transparencia;
                
                const widget = document.getElementById('widgetTemperatura');
                if (widget) {
                    widget.style.opacity = transparencia;
                }
                
                console.log(`Transparencia cambiada a: ${transparencia}`);
            }

            // M√©todo para cambiar posici√≥n din√°micamente
            cambiarPosicion(nuevaPosicion, x = 0, y = 0) {
                this.ESTILO.posicion = nuevaPosicion;
                if (nuevaPosicion === 'personalizada') {
                    this.ESTILO.posicionX = x;
                    this.ESTILO.posicionY = y;
                }
                
                const widget = document.getElementById('widgetTemperatura');
                if (widget) {
                    this.configurarPosicionWidget(widget);
                }
            }

            // M√©todo para cambiar margen din√°micamente
            cambiarMargen(nuevoMargen) {
                // Validar que el valor sea positivo
                const margen = Math.max(0, nuevoMargen);
                this.ESTILO.margen = margen;
                
                const widget = document.getElementById('widgetTemperatura');
                if (widget) {
                    this.configurarPosicionWidget(widget);
                }
                
                console.log(`Margen cambiado a: ${margen}px`);
            }

            // M√©todo para cambiar mensajes din√°micamente
            cambiarMensajes(nuevosMensajes) {
                this.ESTILO.mensajes = { ...this.ESTILO.mensajes, ...nuevosMensajes };
                
                // Actualizar mensaje actual
                this.actualizarTemperatura();
                
                console.log('Mensajes actualizados:', this.ESTILO.mensajes);
            }

            // M√©todo para cambiar un mensaje espec√≠fico
            cambiarMensaje(categoria, nuevoTexto, nuevaAccion = null) {
                if (this.ESTILO.mensajes[categoria]) {
                    this.ESTILO.mensajes[categoria].texto = nuevoTexto;
                    if (nuevaAccion) {
                        this.ESTILO.mensajes[categoria].accion = nuevaAccion;
                    }
                    
                    // Actualizar mensaje actual si corresponde
                    this.actualizarTemperatura();
                    
                    console.log(`Mensaje '${categoria}' actualizado:`, this.ESTILO.mensajes[categoria]);
                }
            }

            // M√©todo para mostrar/ocultar mensajes
            mostrarOcultarMensaje(mostrar) {
                this.ESTILO.mostrarMensaje = mostrar;
                
                const mensaje = document.getElementById('mensaje');
                if (mostrar) {
                    mensaje.style.display = 'block';
                    // Actualizar mensaje actual
                    this.actualizarTemperatura();
                } else {
                    mensaje.style.display = 'none';
                }
                
                console.log(`Mensajes ${mostrar ? 'activados' : 'desactivados'}`);
            }

            // M√©todo para cambiar border radius din√°micamente
            cambiarBordeRadio(nuevoRadio) {
                this.ESTILO.bordeRadio = nuevoRadio;
                
                const widget = document.getElementById('widgetTemperatura');
                if (widget) {
                    this.configurarBordesWidget(widget);
                }
                
                console.log(`Border radius cambiado a: ${nuevoRadio}`);
            }

            // M√©todo para hacer el widget circular
            hacerCircular() {
                this.cambiarBordeRadio('circular');
            }

            // M√©todo para hacer el widget cuadrado
            hacerCuadrado() {
                this.cambiarBordeRadio(0);
            }
        }

        // ‚úÖ La configuraci√≥n ahora se carga desde config.js
        let pantalla;

        // Inicializar cuando la p√°gina cargue
        document.addEventListener('DOMContentLoaded', () => {
            pantalla = new PantallaPersonalizable(configuracion);
        });

        // Funci√≥n opcional para cambiar imagen din√°micamente
        function cambiarImagenPublicitaria(nuevaUrl) {
            if (pantalla) {
                pantalla.cambiarImagen(nuevaUrl);
            }
        }

        // Funci√≥n para cambiar transparencia din√°micamente
        function cambiarTransparencia(valor) {
            if (pantalla) {
                pantalla.cambiarTransparencia(valor);
            }
        }

        // Funci√≥n para cambiar posici√≥n din√°micamente
        function cambiarPosicion(posicion, x = 0, y = 0) {
            if (pantalla) {
                pantalla.cambiarPosicion(posicion, x, y);
            }
        }

        // Funci√≥n para cambiar margen din√°micamente
        function cambiarMargen(nuevoMargen) {
            if (pantalla) {
                pantalla.cambiarMargen(nuevoMargen);
            }
        }

        // Funci√≥n para cambiar mensajes din√°micamente
        function cambiarMensajes(nuevosMensajes) {
            if (pantalla) {
                pantalla.cambiarMensajes(nuevosMensajes);
            }
        }

        // Funci√≥n para cambiar un mensaje espec√≠fico
        function cambiarMensaje(categoria, nuevoTexto, nuevaAccion = null) {
            if (pantalla) {
                pantalla.cambiarMensaje(categoria, nuevoTexto, nuevaAccion);
            }
        }

        // Funci√≥n para mostrar/ocultar mensajes
        function mostrarOcultarMensaje(mostrar) {
            if (pantalla) {
                pantalla.mostrarOcultarMensaje(mostrar);
            }
        }

        // Funciones de utilidad para mensajes
        function ocultarMensajes() {
            mostrarOcultarMensaje(false);
        }

        function mostrarMensajes() {
            mostrarOcultarMensaje(true);
        }

        // Funci√≥n para cambiar border radius din√°micamente
        function cambiarBordeRadio(nuevoRadio) {
            if (pantalla) {
                pantalla.cambiarBordeRadio(nuevoRadio);
            }
        }

        // Funciones de utilidad para formas
        function hacerWidgetCircular() {
            if (pantalla) {
                pantalla.hacerCircular();
            }
        }

        function hacerWidgetCuadrado() {
            if (pantalla) {
                pantalla.hacerCuadrado();
            }
        }

        function hacerWidgetRedondeado(radio = 20) {
            cambiarBordeRadio(radio);
        }

        // Funciones de utilidad para transparencia predefinida
        function hacerWidgetOpaco() {
            cambiarTransparencia(1.0);
        }

        function hacerWidgetSemiTransparente() {
            cambiarTransparencia(0.8);
        }

        function hacerWidgetMuyTransparente() {
            cambiarTransparencia(0.5);
        }
    </script>
</body>
</html>